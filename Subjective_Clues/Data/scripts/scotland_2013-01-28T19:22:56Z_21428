Alex Salmond's government has been warned an independent Scotland would need to spend billions of pounds setting up its own intelligence agencies and equipping its network of overseas embassies.David Lidington, a Foreign Office minister, told MPs on Monday that an independent Scotland would face "enormous" costs to build sophisticated new spying and security facilities, and train its agents, before it could persuade MI6 and the CIA to begin co-operating on joint intelligence.Nicola Sturgeon, Scotland's deputy first minister, had earlier told the foreign affairs committee that officials were completing a "substantial piece on work" on a new independent intelligence service to be published in November's Scottish government white paper before the next year's independence referendum.She said she was unable to offer any details until that work was complete, but given that the overall UK budget on MI5, MI6 and the spying centre GCHQ was about £2bn, Scottish spending would be around £200m a year, based on its share of population.Sturgeon anticipated that an independent Scotland would want to guard against cyberterrorism, international terrorism, international organised crime and global instability producing rogue states.Scottish ministers point too at protecting Scotland's oil rigs, collaboration on north Atlantic defence with Scandinavian states, and full membership of Nato but without accepting nuclear weapons on Scottish soil.In addition to the police and armed forces, "Scotland would have an independent domestic intelligence machinery working very closely, sharing intelligence with the rest of the UK," Sturgeon said."We're working through these matters because there are different options that Scotland could take," she added later. "I don't think any of them are beyond the ability of Scotland to implement."Sturgeon came under repeated pressure from the Tory MP for Penrith and the Border, Rory Stewart, a former army officer and Foreign Office diplomat, to explain how an independent Scotland would build, equip, train and fund its own spying and security services.Stewart said the UK's current annual spying and security budget did not include the total historic costs of building and equipping its intelligence services, from setting up secure intelligence units in overseas embassies, training its agents, to building and equipping GCHQ.It would cost billions, he said, to set up the secure communications Scotland needed for its intelligence agencies. For instance, if an independent Scotland wanted to have the same number of embassies overseas as Ireland, which has 97, or Finland, which has 93, it would cost hundreds of millions to equip them.Lidington told the committee, which staged a rare evidence session in Edinburgh as part of its inquiry into the foreign policy implications of independence, that Scotland would also need to prove its internal security was tight enough to protect its allies intelligence."If Scotland were to become an independent state, it would have to consider how she's going to substitute for the UK's arrangements," he said. "The costs of doing so would be enormous, I think, particularly to start up such networks from scratch."In general terms, smaller European countries don't have the security, intelligence apparatus of anything like the scale and professionalism that we do in the UK."Asked about Sturgeon's position that Scotland would want to share intelligence with the rest of the UK, and the US and other allies, Lidington said Scotland would face very tough tests to prove its security systems were tight and capable enough to satisfy its partners.He added later: "It would require all members of that community to be satisfied both that it was to their over all advantage in terms of intelligence gathering and sharing; would Scotland want to be part of that arrangement and most importantly for them, to have confidence in the ability of an independent Scotland's safeguarding of that information."
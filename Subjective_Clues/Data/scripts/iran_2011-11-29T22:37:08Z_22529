There was little dissembling the official nature of the Iranian demonstration that stormed the British embassy and residence in Tehran yesterday. Police used teargas and secured the release of six embassy employees taken by what the semi-official Fars news agency called hardline students. But the students themselves included members of the paramilitary basij brigades and carried banners naming Qassem Suleimani, the commander of the Quds Force, which runs the overseas operations of the Revolutionary Guard. This may not have been a government-sanctioned operation but it was an official one, with three conservative institutions, the parliament, the judiciary and the supreme leader, behind it.So what was going on? The figleaf behind which Britain normally hides is to say that the embassy was attacked because it was there. True, British diplomats had been anticipating a major protest to mark the anniversary of the assassination of the senior Iranian nuclear scientist Majid Shahriari. Shahriari was killed by a hit team on motorcycles, for which Iran has blamed the Mossad. But there is more to this than the traditional Iranian belief, grounded, it has to be said, in history, that Britain is the master string-puller behind all that is bad that happens in Tehran. Britain was the first to cut off dealings with Iran's central bank, following this month's critical report on the Iranian nuclear programme by the International Atomic Energy Agency. Both the US and the EU have yet to do this. Italy and Spain, the largest buyers of Iran's oil in Europe, are opposed to targeting the central bank. As the oil industry, from which the Revolutionary Guard receives its income, relies heavily on the central bank for most of its transactions, Britain presents an obvious target. The Iranian parliament, the Majlis, voted to expel the British ambassador Dominick Chilcott on Sunday, and the parliamentary speaker Ali Larijani called the vote "just the beginning of the road". Another Iranian MP was quoted as saying that Britain needed a punch in the mouth. The attack on the embassy was well signposted.The fact that Suleimani's name was on the Revolutionary Guard's calling card is also significant. This is a power struggle on which the west's favourite bete noire, Mahmoud Ahmadinejad, is currently on the losing side. It is Ahmadinejad's government that is pressing for a fresh round of talks with the permanent five members of the UN security council, plus Germany, and, according to yesterday's evidence, the leadership of the Revolutionary Guard is trying to stop it.It is exactly for this reason that Britain's reaction to a piece of theatre, albeit an ugly one, should be measured. It may have to abandon its embassy and residence in Tehran. But the talks with the P5+1 should go ahead. The path on which Britain has strode with Iran's nuclear programme – accelerated and tougher economic sanctions – will not work on a country with porous borders and China as a ready buyer of Iranian oil. Nor will it work in the absence of a positive incentive to talk. The report of the IAEA, despite the heavy pre-publication spin, did not essentially contradict the NIE report in 2007, which said that Iran had halted its nuclear weapons programme in 2003. Instead the IAEA said that although there was evidence that some work had continued, it was not as strong as the evidence before the 2003 decision. While this ambiguity exists, a window for talks remains. It is still not too late to turn Iran from a regional source of instability to its opposite, the power that allows the US to disengage from either of the country's borders.
Months of European efforts to come up with common policies on mass immigration unravelled on Sunday when Germany led a “coalition of the willing” of nine EU countries taking in most refugees from the Middle East, splitting the union formally on the issues of mandatory refugee-sharing and funding.An unprecedented full EU summit with Turkey agreed a fragile pact aimed at stemming the flow of migrants to Europe via Turkey.But the German chancellor, Angela Merkel, frustrated by the resistance in Europe to her policies, also convened a separate mini-summit with seven other leaders to push a fast-track deal with the Turks and to press ahead with a new policy of taking in and sharing hundreds of thousands of refugees a year directly from Turkey.The surprise mini-summit suggested that Merkel has given up on trying to persuade her opponents, mostly in eastern Europe, to join a mandatory refugee-sharing scheme across the EU, although she is also expected to use the pro-quotas coalition to pressure the naysayers into joining later.Merkel’s ally on the new policy, Jean-Claude Juncker, president of the European commission, said of the mini-summit: “This is a meeting of those states which are prepared to take in large numbers of refugees from Turkey legally.” Related: Hiding in plain sight: inside the world of Turkey's people smugglers But he added later that any such agreement would be voluntary and not binding, while the Dutch rejected German-led calls to resettle large numbers directly from Turkey.The frictions triggered by the split were instantly apparent. Donald Tusk, the president of the European council who chaired the full summit with Turkey, contradicted the mainly west European emphasis on seeing Ankara as the best hope of slowing the mass migration to Europe. “Let us not be naive. Turkey is not the only key to solving the migration crisis,” said Tusk. “The most important one is our responsibility and duty to protect our external borders. We cannot outsource this obligation to any third country. I will repeat this again: without control on our external borders, Schengen will become history.”He was referring to the 26-country free-travel zone in Europe, which is also in danger of unravelling under the strains of the migratory pressures and jihadist terrorism.Juncker said he would come up with a system for redistributing an annual “contingent” of refugees from Turkey among the coalition of the willing countries. Reports in Berlin put the figure at 400,000.He was expected to leave that until after the looming French regional elections for fear of boosting the chances of the anti-EU, anti-immigrant Front National of Marine Le Pen.Earlier, Turkey promised to help stem the flow of migrants to Europe in return for cash, visas and renewed talks on joining the EU.The Turkish prime minister, Ahmet Davutoglu, called it a “new beginning” for the uneasy neighbours.A key element is €3bn (£2.11bn) in EU aid for the 2.2 million Syrians now in Turkey. The money is intended to raise their living standards and so persuade more of them to stay put rather than attempt perilous crossings to the EU via the Greek islands.The final offer of “an initial” €3bn represents a compromise between the EU, which offered that sum over two years, and Turkey, which wanted it every year. The money will be paid out bit by bit as conditions are met, French president Francois Hollande said, leaving the total payout unclear. “As Turkey is making an effort to take in refugees – who will not come to Europe – it’s reasonable that Turkey receive help from Europe to accommodate those refugees,” Hollande told reporters. He added that the deal should also make it easier to check migrants arriving and keep out those who pose a threat, like Islamic State militants who struck Paris two weeks ago.  Related: EU seeks to buy Turkish help with migrants at controversial summit Also on offer to Ankara, which wants to revive relations with its European neighbours after years of coolness, is a “re-energised” negotiating process on Turkish membership of the EU, even if few expect it to join soon. Many Turks could also benefit from visa-free travel to Europe’s Schengen zone within a year if Turkey meets conditions on tightening its borders in the east to Asian migrants and moves other benchmarks on reducing departures to Europe. “Today is a historic day in our accession process to the EU,” Davutoglu told reporters on arrival. “I am grateful to all European leaders for this new beginning.” David Cameron said: “This summit matters because we need a comprehensive solution to the migrant crisis in Europe and obviously that involves Turkey.“Britain will continue to play our role, which is about supporting Syrian refugees in the refugee camps and in Turkey.“In terms of the discussions this afternoon, a lot of it will be about the Schengen no borders zone that we’re not a member of. Britain in the European Union will keep our border controls, vital to our security that they are.”After the summit, Cameron held talks with Tusk on Britain’s renegotiation with the EU. Downing Street said: “They agreed that we continue to make good progress. While some areas are more difficult than others, discussions are ongoing with member states to find solutions and agree reforms in all four areas outlined in the PM’s letter to the European Council president.“These discussions will continue in the coming days, including with bilaterals between the PM and other European leaders in Paris tomorrow, and all EU leaders will have a substantive discussion of the UK renegotiation at next month’s European council as planned.”
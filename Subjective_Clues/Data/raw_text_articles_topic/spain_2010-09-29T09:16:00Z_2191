Spain's crisis-struck economy is set to lose its top credit rating, held since 2001, in a downgrade expected from Moody's by the end of the week.The credit rating agency is expected to cut Spain's Aaa rating to Aa1 or Aa2. A one-notch cut would put Moody's ranking on a par with Fitch Ratings' AA+ classification, while a two-notch reduction would equal Standard & Poor's.The decision appears to be imminent as Moody's put Spain's debt on review for a possible downgrade on 30 June, saying it would conclude its analysis within three months. It said then that it would take Spain several years to recover from the collapse of its property market, with GDP growth seen at slightly above 1% between 2010 and 2014. Moody's senior credit officer Steven Hess warned at the end of July that the country was likely to lose its top credit rating.Spain faces a general strike today with unions protesting against the government's spending cuts and changes to labour rules.The country grew just 0.2% in the second quarter and 0.1% in the first as unemployment stayed above 20%, the highest in the eurozone. The economy is expected to shrink 0.4% this year.Ireland has also received warnings from S&P that if government support for Anglo Irish Bank exceeds €35bn (£30bn), the country faces another downgrade on its debt rating.
The commemoration of the 31st anniversary of the Islamic revolution turned yesterday into a massive trial of strength between an ever more authoritarian and unpopular government and its ever more determined and durable opposition. President Mahmoud Ahmadinejad told a major rally of supporters that Iran had succeeded in enriching a first batch of uranium to a level of 20% (crossing a technical threshold which opens the way to weapons-grade purity), and thus Iran had become "a nuclear state". He was greeted with loyal chants of "Death to Britain" and "Death to America". Taking ever graver personal risks, opposition demonstrators were pushed underground. There were unprecedented scenes of crowds chanting anti-government slogans in the Tehran metro as well as reports of demonstrations in Isfahan, and cities like Ahvaz that appeared for the first time on the nationwide list of trouble spots.Which side emerged the victor? Consider, first, the measures the government had to take to prevent reality from intruding into its television coverage of the anniversary. It had to hang two prisoners, issue death sentences against nine others, and warn demonstrators that if arrested they too could be charged with the capital offence of moharebeh or "taking up arms against God"; it had to bus in crowds from poor rural areas, bribing them with free handouts of food; it had to surround the route of the march with plain-clothes Basij militia; it had to filter out Gmail and virtually shut down the internet to stop the green movement's message from getting out. But Iran is not China. This government is consumed and all but paralysed by the daily chores of ensuring its own survival.Meanwhile, a protest movement that was sparked by a disputed election and which started with slogans such as "who stole my vote?" has been transformed by the passage of time into one which asks "who stole my revolution?". One measure of this change in mood was the reaction in Tehran to the assassination last month of a leading physics professor who was killed by a remote-controlled bomb. People automatically assumed that the regime had killed one of its own nuclear scientists. Had this murder taken place nine months or a year ago, there would have been little hesitation in thinking that a foreign intelligence service like Mossad was involved.There are several clocks ticking here, and the nuclear one on which western governments concentrate may not be the most important. President Ahmadinejad plays skilfully on the uranium enrichment instrument, hinting at compromises one week and ditching them the next. In reality, there are fewer working centrifuges this year than there were last, because the original Pakistani design is inherently faulty and machines regularly break down. Nor is Iran closer to weaponising its enriched uranium and putting it on a missile, although the IAEA's key questions to Iran on this issue remain unanswered. The nuclear dispute with the west holds several political advantages for the Iranian president. Not only does it fit easily into his narrative of Iran as a state whose Â­development is being thwarted by avaricious foreign powers. It is also a game in which he has many more cards to play.Not so on the domestic front, where the supreme leader Ayatollah Ali Khamenei ran out of cards months ago. Things have moved too far for him to regain the legitimacy he has so quickly squandered. He now finds himself on the horns of a dilemma. Until he compromises with opposition demands to release prisoners, the entire system is threatened. But if he compromises, he risks a backlash from hardliners in his own camp. President Barack Obama should take care with the sanctions he wants the UN to apply. They could end up bolstering the very people they want to weaken. In the end, the only clock worth listening to is the one ticking away under the supreme leader himself.
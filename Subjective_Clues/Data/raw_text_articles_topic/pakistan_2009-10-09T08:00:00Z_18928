Pakistan vowed to press ahead with an assault on the Taliban's mountain stronghold after a huge explosion killed 49 people and wounded more than 100 in a crowded Peshawar marketplace today.The blast ripped through the historic Khyber Bazaar, capping a week of Taliban violence that included attacks on Nato supply convoys and a suicide bombing at a UN office in Islamabad.Television footage showed the charred skeleton of a bus next to the wreckage of a vehicle that police said had been packed with explosives and artillery shells. It was not clear whether the blast was caused by a car bomb or a suicide attack.Nearby vehicles and buildings were in flames as emergency vehicles rushed to the scene, amid pools of blood and billowing clouds of tar-coloured smoke. "It was like doomsday," one survivor told an AP reporter in the ward of an overwhelmed local hospital.Analysts saw the attack as a warning from the Taliban against a much-heralded offensive on their main base in South Waziristan, at the southern end of the tribal belt.Outside parliament, the interior minister, Rehman Malik, said the bombing left the government with "no choice" but to press ahead with its military offensive. "One thing is clear, these hired assassins called Taliban are to be dealt with more severely," he told reporters. "All roads are leading to South Waziristan."Malik added that the police had arrested the "main handler" behind Monday's attack on the UN food agency office in Islamabad. "We have complete information about the persons involved in executing the terrorist plan," he said.For weeks, troops and heavy weapons have been massing on the edge of Waziristan, while warplanes have attacked selected Taliban targets. However a similar build-up at the gates of Waziristan after this summer's Swat offensive did not result in an assault. Army officials said it could be at least another week before this one starts.When it does, it is expected to focus on the tribal base of the Taliban leader Hakimullah Mehsud, who replaced Baitullah Mehsud after the latter was killed in a US drone strike last August. Hakimullah, a young lieutenant with a reputation for ruthlessness, this week vowed to exact vengeance on the US and Pakistani governments.Peshawar, the capital of North West Frontier province, has borne the brunt of Taliban violence in recent years. Today's was the bloodiest atrocity since a suicide bomber killed more than 50 people in a mosque during Friday prayers in Jamrud, on the city's outskirts. It also coincided with a session of the provincial assembly. Local television showed worried politicians emerging from the building, making calls on their mobile phones.The violence comes a background of growing political stability, as the military and civilian government clash over a proposed $7.5bn (Â£4.7bn) US aid package that the army says imposes unfair conditions.On Thursday a meeting of top generals said expressed "serious concern" about the Kerry-Lugar bill, which has yet to be signed into law by US president Barack Obama. President Asif Ali Zardari's spokesman responded forcefully, saying the army had followed incorrect channels in making the statement."We will keep chasing these terrorists and this attack cannot deter our resolve," said the provincial information minister, Mian Iftikhar Hussain.The military has also become embroiled in an acrid political dispute with the civilian government over a proposed five-year, $7.5bn US aid package that the army says imposes unfair conditions.On Thursday a meeting of senior generals expressed "serious concern" about the Kerry-Lugar bill, which requires Pakistan to crack down on Islamists and nuclear proliferation. President Asif Ali Zardari's spokesman responded forcefully to the army statement, criticising the generals for their protest.